{% extends 'base.html' %}
{% block meta %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
{% endblock meta %}

{% block content %}
<div class="m-5 ">
    <div id="container-cards" class="d-flex flex-wrap "></div>
    <button class="btn btn-dark m-4" onclick="location.href = '/barang/upload/'">Upload Barang</button>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        getBarangBekas();
    })

    function getBarangBekas(){
        let temp= "";
        $.ajax({
          url: "{% url 'barang_bekas:get_all_barang_json' %}",
          type: "GET",
          dataType: "json",
          success: function(data){
            console.log('{{ username }}')
            for (let barang of data){
                console.log(barang)

              temp += `<div class="card m-3" style="width: 250px; cursor: pointer;"  onclick="location.href = '/barang/${barang.pk}'">
                <div class="image-container">
                
                    <img src="{{ cloudinary_url }}${barang.fields.foto}" class="img-fluid rounded thumbnail-image" style="object-fit: cover; object-position:center; width: 100%; max-height:250px; filter:${barang.fields.available == true? "grayscale(100%)": "none"} ">

                   ${barang.fields.available == true ? 
                    '<p class="text-danger text-center bg-white rounded opacity-75 p-2 position-absolute z-10" style="top:30%; left:28%;  opacity:80;">Unavailable</p>': ''}
                    
                </div>
                <div class="product-detail-container p-2">
                    <h5 class="product-name text-center">${barang.fields.judul}</h5>
                    <p class="product-description text-center text-truncate">${barang.fields.deskripsi}</p>
                    <div class="d-flex flex-row justify-content-center">
                        <p class=""><i class="fa fa-map-marker px-1" style="color:red"></i>${barang.fields.lokasi}</p>
                        <p class="badge bg-secondary mx-2">${barang.fields.kategori}</p>
                        {% comment %} <a class="px-2" style="cursor: pointer"><i class="fa fa-solid fa-comments" style="font-size:20px"></i></a> {% endcomment %}
                    </div>
                </div>
            </div>`
                    
  
            }
            $('#container-cards').html(temp);
          } ,
          error: function(data){
              console.log('Error Detected');
          }
      })}

</script>

{% endblock content %}
